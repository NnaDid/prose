<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>test</title>
</head>
<body>

    <input type="file" id="fileupload" />
    <script>

        (function(){
            const CLOUDINARY_URL           = 'https://api.cloudinary.com/v1_1/dkazbyl4x/image/upload';
            const CLOUDINARY_UPLOAD_PRESET = 'prosecare';
            const image                    = document.querySelector('#fileupload');
            image.addEventListener('change', (e) => {
                const file                 = e.target.files[0];
                const formData             = new FormData();
                formData.append('file', file);
                formData.append('upload_preset', CLOUDINARY_UPLOAD_PRESET);

                fetch(CLOUDINARY_URL, {
                    method: 'POST',
                    body: formData,
                })
                .then(response => response.json())
                    .then((data) => {
                        if (data.secure_url !== '') {
                            console.log(data.secure_url);
                            console.log(document.top);

                            const uploadedFileUrl = data.secure_url;
                            localStorage.setItem('passportUrl', uploadedFileUrl);
                        }
                    })
                    .catch(err => console.error(err));
            });



            function uploadImage(id,email){
                const CLOUDINARY_URL           = 'https://api.cloudinary.com/v1_1/dkazbyl4x/image/upload';
                const CLOUDINARY_UPLOAD_PRESET = 'prosecare';
                const image                    = document.querySelector('#fileupload');
                image.addEventListener('change', (e) => {
                    const file                 = e.target.files[0];
                    const formData             = new FormData();
                    formData.append('file', file);
                    formData.append('upload_preset', CLOUDINARY_UPLOAD_PRESET);

                    fetch(CLOUDINARY_URL, {
                        method: 'POST',
                        body: formData,
                    })
                    .then(response => response.json())
                        .then((data) => {
                            if (data.secure_url !== '') {
                                console.log(data.secure_url);
                                const uploadedFileUrl = data.secure_url;
                                localStorage.setItem('passportUrl', uploadedFileUrl);
                            }
                        })
                        .catch(err => console.error(err));
                });
            }
        })()

    </script>

</body>
</html>